"use strict";(globalThis.webpackChunkmoowoodle=globalThis.webpackChunkmoowoodle||[]).push([[578],{40318:(t,e,o)=>{o.d(e,{A:()=>D});var r=o(17380),i=o(31354),n=o(77857),l=o(87724),s=o(51609),a=o.n(s),h=o(5821),d=o.n(h);if("undefined"!=typeof Element&&!Element.prototype.matches){var c=Element.prototype;c.matches=c.matchesSelector||c.mozMatchesSelector||c.msMatchesSelector||c.oMatchesSelector||c.webkitMatchesSelector}var g=function(t,e,o){for(var r=t;r;){var i=r===o||r===document.body;if(i||1===r.nodeType&&r.matches(e)){i&&(r=null);break}r=r.parentNode}return r},u=function(t,e){return Array.from(t.parentNode.children).filter(function(t){return""===e||!t.matches(e)}).indexOf(t)},p="px",f=function(t){function e(t){(0,r.A)(this,e);var o=(0,n.A)(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.onMouseDown=o.onMouseDown.bind(o),o.onDragStart=o.onDragStart.bind(o),o.onDragEnter=o.onDragEnter.bind(o),o.onDragEnd=o.onDragEnd.bind(o),o.autoScroll=o.autoScroll.bind(o),o.state={fromIndex:-1,toIndex:-1},o.scrollElement=null,o.scrollTimerId=-1,o.direction=3,o}return(0,l.A)(e,t),(0,i.A)(e,[{key:"componentWillUnmount",value:function(){this.dragLine&&this.dragLine.parentNode&&(this.dragLine.parentNode.removeChild(this.dragLine),this.dragLine=null,this.cacheDragTarget=null)}},{key:"onMouseDown",value:function(t){this.startDrag(t)}},{key:"onDragStart",value:function(t){var e=this.getDragNode(t.target),o=t;if(e){var r=e.parentNode;o.dataTransfer.setData("Text",""),o.dataTransfer.effectAllowed="move",r.ondragenter=this.onDragEnter,r.ondragover=function(t){return t.preventDefault(),!0};var i=u(e,this.props.ignoreSelector);this.setState({fromIndex:i,toIndex:i}),this.scrollElement=function(t){var e=t;do{var o=window.getComputedStyle(e).overflow;if(("auto"===o||"scroll"===o)&&e&&e.nodeType&&(e.offsetWidth<e.scrollWidth||e.offsetHeight<e.scrollHeight))break;if(!e||!e.nodeType||e===document.body){e=null;break}e=e.parentNode}while(e);return e}(r)}}},{key:"onDragEnter",value:function(t){var e=this.getDragNode(t.target),o=t,r=void 0;e?(r=u(e,this.props.ignoreSelector),this.props.enableScroll&&this.resolveAutoScroll(o,e)):(r=-1,this.stopAutoScroll()),this.cacheDragTarget=e,this.setState({toIndex:r}),this.fixDragLine(e)}},{key:"onDragEnd",value:function(t){var e=this.getDragNode(t.target);this.stopAutoScroll(),e&&(e.removeAttribute("draggable"),e.ondragstart=null,e.ondragend=null,e.parentNode.ondragenter=null,e.parentNode.ondragover=null,this.state.fromIndex>=0&&this.state.fromIndex!==this.state.toIndex&&this.props.onDragEnd(this.state.fromIndex,this.state.toIndex)),this.hideDragLine(),this.setState({fromIndex:-1,toIndex:-1})}},{key:"getDragNode",value:function(t){return g(t,this.props.nodeSelector,this.dragList)}},{key:"getHandleNode",value:function(t){return g(t,this.props.handleSelector||this.props.nodeSelector,this.dragList)}},{key:"getDragLine",value:function(){return this.dragLine||(this.dragLine=window.document.createElement("div"),this.dragLine.setAttribute("style","position:fixed;z-index:9999;height:0;margin-top:-1px;border-bottom:dashed 2px red;display:none;"),window.document.body.appendChild(this.dragLine)),this.dragLine.className=this.props.lineClassName||"",this.dragLine}},{key:"startDrag",value:function(t){var e=this.getHandleNode(t.target);if(e){var o=this.props.handleSelector&&this.props.handleSelector!==this.props.nodeSelector?this.getDragNode(e):e;o&&(e.setAttribute("draggable",!1),o.setAttribute("draggable",!0),o.ondragstart=this.onDragStart,o.ondragend=this.onDragEnd)}}},{key:"resolveAutoScroll",value:function(t,e){if(this.scrollElement){var o=this.scrollElement.getBoundingClientRect(),r=o.top,i=o.height,n=e.offsetHeight,l=t.pageY,s=n*(2/3);this.direction=0,l>r+i-s?this.direction=3:l<r+s&&(this.direction=1),this.direction?this.scrollTimerId<0&&(this.scrollTimerId=setInterval(this.autoScroll,20)):this.stopAutoScroll()}}},{key:"stopAutoScroll",value:function(){clearInterval(this.scrollTimerId),this.scrollTimerId=-1,this.fixDragLine(this.cacheDragTarget)}},{key:"autoScroll",value:function(){var t=this.scrollElement.scrollTop;3===this.direction?(this.scrollElement.scrollTop=t+this.props.scrollSpeed,t===this.scrollElement.scrollTop&&this.stopAutoScroll()):1===this.direction?(this.scrollElement.scrollTop=t-this.props.scrollSpeed,this.scrollElement.scrollTop<=0&&this.stopAutoScroll()):this.stopAutoScroll()}},{key:"hideDragLine",value:function(){this.dragLine&&(this.dragLine.style.display="none")}},{key:"fixDragLine",value:function(t){var e=this.getDragLine();if(!t||this.state.fromIndex<0||this.state.fromIndex===this.state.toIndex)this.hideDragLine();else{var o=t.getBoundingClientRect(),r=o.left,i=o.top,n=o.width,l=o.height,s=this.state.toIndex<this.state.fromIndex?i:i+l;if(this.props.enableScroll&&this.scrollElement){var a=this.scrollElement.getBoundingClientRect(),h=a.height,d=a.top;if(s<d-2||s>d+h+2)return void this.hideDragLine()}e.style.left=r+p,e.style.width=n+p,e.style.top=s+p,e.style.display="block"}}},{key:"render",value:function(){var t=this;return a().createElement("div",{role:"presentation",onPointerDown:this.onMouseDown,ref:function(e){t.dragList=e}},this.props.children)}}]),e}(s.Component);f.propTypes={onDragEnd:d().func.isRequired,handleSelector:d().string,nodeSelector:d().string,ignoreSelector:d().string,enableScroll:d().bool,scrollSpeed:d().number,lineClassName:d().string,children:d().node},f.defaultProps={nodeSelector:"tr",ignoreSelector:"",enableScroll:!0,scrollSpeed:10,handleSelector:"",lineClassName:"",children:null};const m=f;var v=o(58770),S="px";const y=function(t){function e(){return(0,r.A)(this,e),(0,n.A)(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return(0,l.A)(e,t),(0,i.A)(e,[{key:"getDragLine",value:function(){return this.dragLine||((0,v.A)(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"getDragLine",this).call(this),this.dragLine.setAttribute("style",this.dragLine.getAttribute("style")+"width:0;margin-left:-1px;margin-top:0;border-bottom:0 none;border-left:dashed 2px red;")),this.dragLine}},{key:"resolveAutoScroll",value:function(t,e){if(this.scrollElement){var o=this.scrollElement.getBoundingClientRect(),r=o.left,i=o.width,n=e.offsetWidth,l=t.pageX,s=2*n/3;this.direction=0,l>r+i-s?this.direction=2:l<r+s&&(this.direction=4),this.direction?this.scrollTimerId<0&&(this.scrollTimerId=setInterval(this.autoScroll,20)):this.stopAutoScroll()}}},{key:"autoScroll",value:function(){var t=this.scrollElement.scrollLeft;2===this.direction?(this.scrollElement.scrollLeft=t+this.props.scrollSpeed,t===this.scrollElement.scrollLeft&&this.stopAutoScroll()):4===this.direction?(this.scrollElement.scrollLeft=t-this.props.scrollSpeed,this.scrollElement.scrollLeft<=0&&this.stopAutoScroll()):this.stopAutoScroll()}},{key:"fixDragLine",value:function(t){var e=this.getDragLine();if(!t||this.state.fromIndex<0||this.state.fromIndex===this.state.toIndex)this.hideDragLine();else{var o=t.getBoundingClientRect(),r=o.left,i=o.top,n=o.width,l=o.height,s=this.state.toIndex<this.state.fromIndex?r:r+n;if(this.props.enableScroll&&this.scrollElement){var a=this.scrollElement.getBoundingClientRect(),h=a.width,d=a.left;if(s<d-2||s>d+h+2)return void this.hideDragLine()}e.style.top=i+S,e.style.height=l+S,e.style.left=s+S,e.style.display="block"}}}]),e}(m);m.DragColumn=y;const D=m}}]);