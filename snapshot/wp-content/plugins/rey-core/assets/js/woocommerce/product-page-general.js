!function(e){"use strict";var t=function(){var t=this;this.init=function(){this.$productPage=e("div.product"),this.productPage=document.querySelector("div.product"),this.general(),this.reviewsBtn(),this.handleQtyInputMinStep(),this.reviewsForm(),this.addedToCartText(),this.fsSkinErrors(),this.runLazyReviews(),this.runLazyRelated(),this.runLazyUpsells(),this.events()},this.events=function(){e(document).on("focus",".rey-cartBtnQty input.--select-text",(function(e){e.currentTarget.select()})),rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.customTextNearPrice()}),2e3)}))},this.reviewsBtn=function(){var e=document.querySelector(".js-reviewsBtn");if(e){var t=document.querySelector(".rey-wcPanel--reviews #reviews");t&&(e.classList.contains("--toggled")?rey.dom.isHidden(t)&&rey.animation.slideDown(t):rey.dom.isHidden(t)||(t.style.display="none"),e.addEventListener("click",(function(e){e.preventDefault(),e.currentTarget.classList.contains("--toggled")?(e.currentTarget.classList.remove("--toggled"),rey.animation.slideUp(t)):(e.currentTarget.classList.add("--toggled"),rey.animation.slideDown(t))})),e&&rey.dom.delegate(document,"click",'.woocommerce-review-link, a[href="#reviews"]',(function(a){var r=rey.dom.offset(e).top;r&&(a.preventDefault(),window.scrollTo({top:r-30,behavior:"smooth"})),rey.dom.isHidden(t)&&e.click()})))}},this.reviewsForm=function(){if(reyParams.ajax_add_review){var e=document.querySelector("#comments .commentlist");rey.dom.delegate(document,"submit","#respond form.comment-form",(function(t){t.preventDefault();var a=t.initiator,r=a.querySelector("#comment");if(r)if(r.value){t.submitter.classList.add("loading-spin");var o=rey.util.getFormData(a);Object.keys(o).length?rey.ajax.request("submit_review",{formData:o,params:{cache:!1},cb:function(r){if(r&&r.success&&r.data){if(!e)return t.submitter.value=reyParams.ajax_add_review_reload_text,void setTimeout((function(){window.location.reload()}),1e3);t.submitter.classList.remove("loading-spin"),rey.dom.insertHtml(e,"afterbegin",r.data),window.scrollTo({top:rey.dom.offset(e).top,behavior:"smooth"});var o=document.getElementById("review_form");o&&(o.style.display="none"),a.reset()}}}):console.error("Form data empty. Please reload and try again.")}else r.style.borderColor="red";else console.error("Missing comment field.")}))}},this.addedToCartText=function(){e(document.body).on("added_to_cart",(function(t,a,r,o){if(void 0!==reyParams.added_to_cart_text){var i;if(o)if(o.hasClass("single_add_to_cart_button")&&!o.hasClass("elementor-button"))i=o,o=e(".single_add_to_cart_button-text",o);else if(o.hasClass("add_to_cart_button")){var n=e(".__text",o);n.length?o=n:o.children(".rey-icon").length&&(o=null)}if(o){var s=o.text();o.text(reyParams.added_to_cart_text);var d=parseInt(reyParams.added_to_cart_text_timeout||0);d&&setTimeout((function(){o.text(s),i&&i.removeClass("added")}),d)}}}))},this.fsSkinErrors=function(){if(!rey.vars.is_desktop){var t=e(".single-skin--fullscreen .woocommerce-notices-wrapper");t.length&&t.detach().prependTo(this.$productPage)}},this.general=function(){e('.rey-qtySelect ~ input[name="quantity"]').remove()},this.ajaxLoadMoreReviews=function(){e(document).on("click",".rey-ajaxRatings-addBtn, .rey-reviewTop-add",(function(t){t.preventDefault();var a=e("#review_form_wrapper"),r=a.offset().top;a.children("#review_form").show("fast"),e("html, body").animate({scrollTop:r-rey.vars.adminBar-25},"fast",(function(e){return--e*e*e+1})),setTimeout((function(){e(document).trigger("reycore/woocommerce/reviews/loaded")}),100)}));var t=e(".rey-ajaxRatings-btn");if(t.length){var a=JSON.parse(t.attr("data-config")||"{}");if(a.qid&&a.total){var r,o=a.total,i=0,n=e("#reviews ol.commentlist"),s="newest",d=function(d,c){r&&r.abort(),r=rey.ajax.request("load_more_reviews",{data:{qid:a.qid,page:i,order:d||s},cb:function(a){t.removeClass("--disabled"),a.success&&a.data?(e("li.__loader",n).remove(),e(a.data).appendTo(n),t.removeClass("--loading"),i++,e(".__count",t).attr("data-current",i),i===o&&t.addClass("--disabled").removeClass("--loading"),c&&c.removeClass("--disabled"),e(document).trigger("reycore/woocommerce/reviews/loaded"),r=!1):t.addClass("--disabled").removeClass("--loading")}})};d(),t.on("click",(function(e){e.preventDefault(),t.addClass("--loading"),d()})),e(document).on("click",".rey-reviewSort li[data-key]",(function(){var a=e(this),r=a.parent(),o=a.attr("data-key");r.addClass("--disabled"),n.empty(),e('<li class="__loader"><div class="rey-lineLoader"></div></li>').appendTo(n),t.addClass("--disabled"),e(".__count",t).attr("data-current",1),a.siblings().removeClass("--active"),a.addClass("--active"),i=0,d(o,r),s=o}))}}},this.runLazyUpsells=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.upsells.products");if(t.length){var a=rey.vars.page_id;a&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("upsells_products",{ss:"upsells_products_"+a,data:{id:a},cb:function(e){if(e.data){t.replaceWith(e.data);var a=document.querySelector(".upsells.products");rey.hooks.doAction("product/loaded",a.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",a),rey.hooks.doAction("elementor/content/lazy_loaded",a)}}})}})}}},this.runLazyRelated=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.related.products");if(t.length){var a=rey.vars.page_id;a&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("related_products",{ss:"related_products_"+a,data:{id:a},cb:function(e){if(e.data){t.replaceWith(e.data);var a=document.querySelector(".related.products");rey.hooks.doAction("product/loaded",a.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",a),rey.hooks.doAction("elementor/content/lazy_loaded",a)}}})}})}}},this.runLazyReviews=function(){var t=this,a=e(".woocommerce-Reviews.--ajax");if(a.length){if(a.closest(".rey-summaryAcc").length)return e(document).one("click",".rey-summaryAcc-accItem.--reviews",(function(){t.ajaxLoadMoreReviews()})),void e(document).one("click",".reviews_acctab > a.--reviews",(function(){t.ajaxLoadMoreReviews()}));var r=a.closest(".woocommerce-Tabs-panel").length;if(r&&a.is(":visible"))return t.ajaxLoadMoreReviews();a.is(":visible")||r||!e(".rey-reviewsBtn").length?r?e(document).one("click",".reviews_tab > a",(function(){t.ajaxLoadMoreReviews()})):rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.ajaxLoadMoreReviews()}),2e3)})):e(document).one("click",".rey-reviewsBtn",(function(){t.ajaxLoadMoreReviews()}))}},this.customTextNearPrice=function(){var t=e("span[data-price-text]",this.$productPage);t.length&&rey.ajax.request("pdp_custom_price_text",{data:{pid:t.attr("data-price-text")},params:{cache:!1},cb:function(e){e.data&&t.replaceWith(e.data)}})},this.handleQtyInputMinStep=function(){rey.dom.delegate(document,"change","div.product input.qty",(function(e){var t=parseFloat(e.initiator.getAttribute("min")||0),a=parseFloat(e.initiator.getAttribute("step")||0),r=parseFloat(e.initiator.value);if(t&&t>r)e.initiator.value=t;else if(a&&r%a!=0){var o=Math.floor(r/a)*a;t&&(o=Math.max(t,o)),e.initiator.value=o}}))},this.init()};document.addEventListener("rey-DOMContentLoaded",(function(){new t}));var a={};e(document.body).on("found_variation reset_data",".variations_form",(function(t,r){var o=t.currentTarget.closest("div.product");if(o){o.classList.toggle("--found-variation","object"==typeof r);var i=e(".rey-estimatedDelivery",o);if(i.length){var n=o.getAttribute("id");a[n]||(a[n]=i.html()),r&&r.estimated_delivery?i.html(r.estimated_delivery):i.html(a[n])}}}))}(jQuery);